<?xml version="1.0" ?>
<sdf version="1.9">
	<!-- Sailboat model -->
	<model name="single_sailboat">		
		<!-- Boat -->
		<link name="base_link">
			<pose>0 0 0 0 0 1.5708</pose>
			<inertial>
				<mass>2.5</mass>
				<inertia>
					<ixx>0.00589375</ixx>
					<ixy>0</ixy>
					<ixz>0</ixz>
					<iyy>0.076171875</iyy>
					<iyz>0</iyz>
					<izz>0.0796875</izz>
				</inertia>
			</inertial>

			<collision name="base_link_collision">
				
				<geometry>
					<box>
						<size>0.6 0.15 0.075</size>
					</box> 
					
				</geometry>
			</collision>

			<visual name="base_link_visual">
				<geometry>
					<mesh>
						<uri>meshes/sailboat.dae</uri>
					</mesh>
				</geometry>
				<material>
					<ambient>0.0 0.0 1.0 1</ambient>
					<diffuse>0.0 0.0 1.0 1</diffuse>
					<specular>0.0 0.0 1.0 1</specular>
					<!--<pbr>
						<metal>
							<albedo_map>wood.png</albedo_map>
							<normal_map>wood.png</albedo_map>
						</metal>
					</pbr>-->
				</material>
			</visual>
		</link>
		<link name="secondary_link">
			<pose>0.1725 0 0.09 0 1.570796327 0</pose>
			<inertial>
				<mass>0.5</mass>
				<inertia>
					<ixx>0.0158</ixx>
					<ixy>0</ixy>
					<ixz>0</ixz>
					<iyy>0.0016</iyy>
					<iyz>0</iyz>
					<izz>0.0158</izz>
				</inertia>
			</inertial>
			<!--<visual name= "secondary_visual">
				<geometry>
					<cylinder>
						<radius>0.08</radius>
						<length>0.6</length>
					</cylinder>
				</geometry>
				<material>
					<ambient>0.0 0.0 1.0 1</ambient>
					<diffuse>0.0 0.0 1.0 1</diffuse>
					<specular>0.0 0.0 1.0 1</specular>
				</material>
			</visual>-->
			<collision name="secondary_link_collision">
				<geometry>
					<cylinder>
						<radius>0.15</radius>
						<length>0.6</length>
					</cylinder> 					
				</geometry>
			</collision>
			<self_collide>false</self_collide>
		</link>

		<!-- Rudder -->
		<link name="rudder_fin">
			<pose>-0.45 0 0 0 0 0</pose>
			<inertial>
				<mass>0.2</mass>
				<inertia>
					<ixx>0.00009875</ixx>
					<ixy>0.0</ixy>
					<ixz>0.0</ixz>
					<iyy>0.00009875</iyy>
					<iyz>0.0</iyz>
					<izz>0.00001</izz>
				</inertia>
			</inertial>		
			<collision name="rudder_collision">
				<geometry>
					<box>
						<size>0.1 0.1 0.075</size>
					</box>
				</geometry>
			</collision>
			<visual name= "rudder_visual">
				<pose>0 0 0.05 0 0 1.570796327</pose>
				<geometry>
					<mesh>
						<uri>meshes/direccion.dae</uri>
					</mesh>
				</geometry>
				<material>
					<ambient>0.0 0.0 1.0 1</ambient>
					<diffuse>0.0 0.0 1.0 1</diffuse>
					<specular>0.0 0.0 1.0 1</specular>
				</material>
			</visual>
		</link>
		<!-- Main sail-->
		<link name="sail_link">
			<pose>0 0 0 0 0 0</pose>
			<inertial>
				<mass>0.5</mass>
				<inertia>
					<ixx>0.010466667</ixx>
					<ixy>0.0</ixy>
					<ixz>0.0</ixz>
					<iyy>0.010466667</iyy>
					<iyz>0.0</iyz>
					<izz>0.00001</izz>
				</inertia>
			</inertial>		
			<collision name="sail_collision">
				<pose>0 0 0 0 0 1.570796327</pose>
				<geometry>
					<box>
						<size>0.25 0.01 0.5</size>
					</box>
				</geometry>
			</collision>
			<visual name= "sail_visual">
				<pose>0 0 -0.15 0 0 1.570796327</pose>
				<geometry>
					<mesh>
						<uri>meshes/vela.dae</uri>
					</mesh>
				</geometry>
				<material>
					<ambient>0.0 0.0 1.0 1</ambient>
					<diffuse>0.0 0.0 1.0 1</diffuse>
					<specular>0.0 0.0 1.0 1</specular>
				</material>
			</visual>
			<enable_wind>true</enable_wind>
		</link>
		
		<!-- Keel -->
		<link name="keel_link">
			<pose> 0 0 0 0 0 0 </pose>
			<visual name= "keel_visual">
				<pose>0 0 0.05 0 0 1.570796327</pose>
				<geometry>
					<mesh>
						<uri>meshes/quilla.dae</uri>
					</mesh>
				</geometry>
				<material>
					<ambient>0.0 0.0 1.0 1</ambient>
					<diffuse>0.0 0.0 1.0 1</diffuse>
					<specular>0.0 0.0 1.0 1</specular>
				</material>
			</visual>
			<collision name="keel_collision">
				<geometry>
					<cylinder>
						<length>0.5</length> 
						<radius>0.02</radius>
					</cylinder>
				</geometry>
			</collision>
			<inertial>
				<pose>0 0 -0.25 0 0 0</pose>
				<mass>0.5</mass>
				<inertia>
					<ixx>0.010466667</ixx>
					<ixy>0.0</ixy>
					<ixz>0.0</ixz>
					<iyy>0.010466667</iyy>
					<iyz>0.0</iyz>
					<izz>0.0001</izz>
				</inertia>
			</inertial>
		</link>
		
		<!-- Joints -->
		
		<joint name="rudder_fin_joint" type="revolute">
			<pose>0 0 0 0 0 0</pose>
			<parent>base_link</parent>
			<child>rudder_fin</child>
			<axis>
				<xyz>0 0 1</xyz>
				<limit>
					<lower>-0.261799</lower>
					<upper>0.261799</upper>
					<effort>-1</effort>
					<velocity>-1</velocity>
				</limit>
			</axis>
		</joint>
		<joint name="mainSail_joint" type="revolute">
			<pose>0 0 0 0 0 0</pose>
			<parent>base_link</parent>
			<child>sail_link</child>
			<axis>
				<xyz>0 0 1</xyz>
				<limit>
					<lower>-0.261799</lower>
					<upper>0.261799</upper>
					<effort>-1</effort>
					<velocity>-1</velocity>
				</limit>
			</axis>
		</joint>
		<joint name='keel_joint' type='fixed'>
			<pose relative_to='base_link'>0 0 -0.1 0 0 0</pose>
			<parent>base_link</parent>
			<child>keel_link</child>
			<axis>
				<dynamics>
					<spring_reference>0</spring_reference>
					<spring_stiffness>0</spring_stiffness>
				</dynamics>
				<xyz>0 0 1</xyz>
				<limit>
					<lower>-10000000000000000</lower>
					<upper>10000000000000000</upper>
				</limit>
			</axis>
			<physics>
				<ode>
					<limit>
						<cfm>0</cfm>
						<erp>0.20000000000000001</erp>
					</limit>
				</ode>
			</physics>
		</joint>
		<joint name='secondary_link_joint' type='fixed'>
			<pose relative_to='base_link'>0 0 -0.1 0 0 0</pose>
			<parent>base_link</parent>
			<child>secondary_link</child>
			<axis>
				<dynamics>
					<spring_reference>0</spring_reference>
					<spring_stiffness>0</spring_stiffness>
				</dynamics>
				<xyz>0 0 1</xyz>
				<limit>
					<lower>-10000000000000000</lower>
					<upper>10000000000000000</upper>
				</limit>
			</axis>
			<physics>
				<ode>
					<limit>
						<cfm>0</cfm>
						<erp>0.20000000000000001</erp>
					</limit>
				</ode>
			</physics>
		</joint>
		<!-- Controllers Pluggins -->
		<plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
			<joint_name>rudder_fin_joint</joint_name>
			<p_gain>0.1</p_gain>
		</plugin>
		<plugin filename="gz-sim-joint-position-controller-system" name="gz::sim::systems::JointPositionController">
			<joint_name>mainSail_joint</joint_name>
			<p_gain>0.1</p_gain>
		</plugin>    
		<plugin filename="libgz-sim-pose-publisher-system.so" name="gz::sim::systems::PosePublisher">
			<publish_link_pose>true</publish_link_pose>
			<publish_sensor_pose>true</publish_sensor_pose>
			<publish_collision_pose>false</publish_collision_pose>
			<publish_visual_pose>false</publish_visual_pose>
			<publish_nested_model_pose>true</publish_nested_model_pose>
			<publish_model_pose>false</publish_model_pose>
			<use_pose_vector_msg>true</use_pose_vector_msg>
			<static_publisher>true</static_publisher>
			<static_update_frequency>1</static_update_frequency>
		</plugin>
		
		<!-- Dynamics Pluggins -->
		<plugin filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag">
			<air_density>1000</air_density>
			<cla>4.13</cla>
			<cla_stall>-1.1</cla_stall>
			<cda>0.2</cda>
			<cda_stall>0.03</cda_stall>
			<alpha_stall>0.17</alpha_stall>
			<a0>0</a0>
			<area>0.0244</area>
			<upward>0 1 0</upward>
			<forward>1 0 0</forward>
			<link_name>rudder_fin</link_name>
			<cp>0 0 0</cp>
		</plugin>
		<plugin	filename="gz-sim-lift-drag-system" name="gz::sim::systems::LiftDrag">
		    <air_density>1000</air_density>
		    <cla>4.13</cla>
		    <cla_stall>-1.1</cla_stall>
		    <cda>0.2</cda>
		    <cda_stall>0.03</cda_stall>
		    <alpha_stall>0.17</alpha_stall>
		    <a0>0</a0>
		    <area>0.0244</area>
		    <upward>0 1 0</upward>
		    <forward>1 0 0</forward>
		    <link_name>keel_link</link_name>
		    <cp>0 0 0</cp>
		</plugin>
	</model>
</sdf>
